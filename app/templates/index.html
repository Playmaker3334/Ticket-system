{% extends 'base.html' %}

{% block title %}Tickets{% endblock %}

{% block content %}
  <h1 class="text-white my-4">Tickets</h1>

  <h2 class="text-white my-4">Open Tickets</h2>
  <div class="row">
    {% for ticket in open_tickets %}
      <div class="col-md-4 mb-3">
        <div class="card bg-light text-dark h-100">
          <div class="card-body">
            <a href="{{ url_for('ticket', ticket_id=ticket.id) }}" class="text-dark text-decoration-none">
              <h5 class="card-title">{{ ticket.title }}</h5>
            </a>
            <h6 class="card-subtitle mb-2 text-muted">Created at: {{ ticket.created_at }}</h6>
            <p class="card-text">Assigned to: {{ ticket.assigned_to }}</p> <!-- Mostrar el nuevo campo -->
            <a href="{{ url_for('edit_ticket', ticket_id=ticket.id) }}" class="btn btn-outline-dark btn-sm">Edit</a>
            <a href="{{ url_for('set_status', ticket_id=ticket.id, status='in progress') }}" class="btn btn-outline-warning btn-sm">Set In Progress</a>
            <a href="{{ url_for('set_status', ticket_id=ticket.id, status='finished') }}" class="btn btn-outline-success btn-sm">Set Finished</a>
            <a href="{{ url_for('delete_ticket', ticket_id=ticket.id) }}" class="btn btn-outline-danger btn-sm" onclick="return confirm('Are you sure you want to delete this ticket?');">Delete</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <h2 class="text-white my-4">In Progress Tickets</h2>
  <div class="row">
    {% for ticket in in_progress_tickets %}
      <div class="col-md-4 mb-3">
        <div class="card bg-light text-dark h-100">
          <div class="card-body">
            <a href="{{ url_for('ticket', ticket_id=ticket.id) }}" class="text-dark text-decoration-none">
              <h5 class="card-title">{{ ticket.title }}</h5>
            </a>
            <h6 class="card-subtitle mb-2 text-muted">Created at: {{ ticket.created_at }}</h6>
            <p class="card-text">Assigned to: {{ ticket.assigned_to }}</p> <!-- Mostrar el nuevo campo -->
            <a href="{{ url_for('edit_ticket', ticket_id=ticket.id) }}" class="btn btn-outline-dark btn-sm">Edit</a>
            <a href="{{ url_for('set_status', ticket_id=ticket.id, status='finished') }}" class="btn btn-outline-success btn-sm">Set Finished</a>
            <a href="{{ url_for('delete_ticket', ticket_id=ticket.id) }}" class="btn btn-outline-danger btn-sm" onclick="return confirm('Are you sure you want to delete this ticket?');">Delete</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>

  <h2 class="text-white my-4">Finished Tickets</h2>
  <div class="row">
    {% for ticket in finished_tickets %}
      <div class="col-md-4 mb-3">
        <div class="card bg-light text-dark h-100">
          <div class="card-body">
            <a href="{{ url_for('ticket', ticket_id=ticket.id) }}" class="text-dark text-decoration-none">
              <h5 class="card-title">{{ ticket.title }}</h5>
            </a>
            <h6 class="card-subtitle mb-2 text-muted">Created at: {{ ticket.created_at }}</h6>
            <p class="card-text">Assigned to: {{ ticket.assigned_to }}</p> <!-- Mostrar el nuevo campo -->
            <a href="{{ url_for('edit_ticket', ticket_id=ticket.id) }}" class="btn btn-outline-dark btn-sm">Edit</a>
            <a href="{{ url_for('set_status', ticket_id=ticket.id, status='open') }}" class="btn btn-outline-primary btn-sm">Set Open</a>
            <a href="{{ url_for('delete_ticket', ticket_id=ticket.id) }}" class="btn btn-outline-danger btn-sm" onclick="return confirm('Are you sure you want to delete this ticket?');">Delete</a>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% endblock %}







